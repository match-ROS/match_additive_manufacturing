<launch>
    <!-- Parameters: -->
    <arg name="nozzle_height_default" default="0.1"/>
    <arg name="kp_z" default="0.7"/>
    <arg name="ki_z" default="0.0"/>
    <arg name="kd_z" default="0.0"/>

    <!-- Topics: -->
    <arg name="path_ns" default="" doc="Namespace prefix for UR path topics (with or without leading slash)."/>
    <arg name="path_ns_prefix" default="$(eval '/' + path_ns.strip('/') if path_ns else '')"/>
    <arg name="path_topic" default="$(arg path_ns_prefix)/ur_path_transformed"/>
    <arg name="path_index_topic" default="$(arg path_ns_prefix)/path_index"/>
    <arg name="current_pose_topic" default="/global_nozzle_pose"/>
    <arg name="velocity_override_topic" default="/velocity_override"/>
    <arg name="nozzle_height_override_topic" default="/nozzle_height_override"/>
    <arg name="twist_topic" default="/ur_error_world"/>
    <arg name="ff_only" default="true"/>
    <arg name="from_index_offset" default="-1"/>
    <arg name="to_index_offset" default="0"/>
    <arg name="start_condition_topic" default="/start_condition"/>
    <arg name="wait_for_start_condition" default="true"/>
    <arg name="initial_path_index" default="-1"/>

    <node name="ur_direction_controller" pkg="ur_trajectory_follower" type="ur_path_direction_controller.py" output="screen">
        <!-- Parameters -->
        <param name="nozzle_height_default" value="$(arg nozzle_height_default)"/>
        <param name="kp_z" value="$(arg kp_z)"/>
        <param name="ki_z" value="$(arg ki_z)"/>
        <param name="kd_z" value="$(arg kd_z)"/>
        <param name="ff_only" value="$(arg ff_only)"/>
        <param name="start_condition_topic" value="$(arg start_condition_topic)"/>
        <param name="wait_for_start_condition" value="$(arg wait_for_start_condition)"/>
        <param name="initial_path_index" value="$(arg initial_path_index)"/>
        
        <!-- Topic Remapping -->
        <remap from="/path" to="$(arg path_topic)"/>
        <remap from="/path_index" to="$(arg path_index_topic)"/>
        <remap from="/current_pose" to="$(arg current_pose_topic)"/>
        <remap from="/velocity_override" to="$(arg velocity_override_topic)"/>
        <remap from="/nozzle_height_override" to="$(arg nozzle_height_override_topic)"/>
        <remap from="/ur_twist_world" to="$(arg twist_topic)"/>
    </node>
</launch>